"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function asyncGeneratorStep(e,t,r,n,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(c){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=c.apply(e,a);function i(e){asyncGeneratorStep(n,t,r,i,o,"next",e)}function o(e){asyncGeneratorStep(n,t,r,i,o,"throw",e)}i(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){var l,t=Object.prototype,s=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",n=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag",a="object"===("undefined"==typeof module?"undefined":_typeof(module)),c=e.regeneratorRuntime;if(c)a&&(module.exports=c);else{(c=e.regeneratorRuntime=a?module.exports:{}).wrap=g;var h="suspendedStart",d="suspendedYield",f="executing",m="completed",v={},u={};u[i]=function(){return this};var p=Object.getPrototypeOf,y=p&&p(p(D([])));y&&y!==t&&s.call(y,i)&&(u=y);var _=w.prototype=L.prototype=Object.create(u);k.prototype=_.constructor=w,w.constructor=k,w[o]=k.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(_),e},c.awrap=function(e){return{__await:e}},x(C.prototype),C.prototype[n]=function(){return this},c.AsyncIterator=C,c.async=function(e,t,r,n){var i=new C(g(e,t,r,n));return c.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},x(_),_[o]="Generator",_[i]=function(){return this},_.toString=function(){return"[object Generator]"},c.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},c.values=D,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=l),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=s.call(i,"catchLoc"),c=s.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=l),v}}}function g(e,t,r,n){var o,a,c,l,i=t&&t.prototype instanceof L?t:L,s=Object.create(i.prototype),u=new T(n||[]);return s._invoke=(o=e,a=r,c=u,l=h,function(e,t){if(l===f)throw new Error("Generator is already running");if(l===m){if("throw"===e)throw t;return M()}for(c.method=e,c.arg=t;;){var r=c.delegate;if(r){var n=V(r,c);if(n){if(n===v)continue;return n}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===h)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=f;var i=b(o,a,c);if("normal"===i.type){if(l=c.done?m:d,i.arg===v)continue;return{value:i.arg,done:c.done}}"throw"===i.type&&(l=m,c.method="throw",c.arg=i.arg)}}),s}function b(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function L(){}function k(){}function w(){}function x(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function C(l){var t;this._invoke=function(r,n){function e(){return new Promise(function(e,t){!function t(e,r,n,i){var o=b(l[e],l,r);if("throw"!==o.type){var a=o.arg,c=a.value;return c&&"object"===_typeof(c)&&s.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):Promise.resolve(c).then(function(e){a.value=e,n(a)},i)}i(o.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function V(e,t){var r=e.iterator[t.method];if(r===l){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=l,V(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=b(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,v;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=l),t.delegate=null,v):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function D(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(s.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=l,e.done=!0,e};return n.next=n}}return{next:M}}function M(){return{value:l,done:!0}}}(function(){return this}()||Function("return this")());var url="https://markoboy.github.io/Versa-Connect-DeveloperTask",getData=function(){return fetch("".concat(url,"/data/vehicles.json")).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).catch(function(e){return console.error("Error occured when fetching vehicles data",e),e})},Controller=function(){function e(){_classCallCheck(this,e)}var t;return _createClass(e,null,[{key:"init",value:(t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getData();case 2:this.vehicles=e.sent,this.currentVehicle=this.vehicles[0],View.init();case 5:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getUrl",value:function(){return{main:url,images:url+"/images/"}}},{key:"getVehicles",value:function(){return this.vehicles}},{key:"getVehicle",value:function(t){return this.vehicles.filter(function(e){return e.id===t})[0]}},{key:"setCurrentVehicle",value:function(t){this.currentVehicle=this.vehicles.filter(function(e){return e.id===t})[0]}},{key:"getCurrentVehicle",value:function(){return this.currentVehicle}}]),e}();document.addEventListener("DOMContentLoaded",function(){Controller.init()});var View=function(){function e(){_classCallCheck(this,e)}var r;return _createClass(e,null,[{key:"init",value:function(){this.vehicles=Controller.getVehicles(),this.currentVehicle=Controller.getCurrentVehicle(),this.url=Controller.getUrl(),this.currentDetails="dimensions",this.vehicleDetailsBtn=document.querySelectorAll(".vehicle-details__nav__btn"),this.initVehicleDetailsBtn(this.currentDetails),this.currentColor=this.currentVehicle.colors.nonMetallic[0],this.render()}},{key:"render",value:function(){if(this.oldVehicle!==this.currentVehicle){this.renderModelNav(this.currentVehicle),this.renderMainBillboard(this.currentVehicle);this.handleVehicleGallery(this.currentVehicle,0),this.renderVehicleDescription(this.currentVehicle),this.handleOffersBtn(this.currentVehicle),this.handleInterestedModal(this.currentVehicle),this.initColorButtons(),this.oldVehicle=this.currentVehicle}this.oldVehicle===this.currentVehicle&&this.oldDetails===this.currentDetails||(this.renderVehicleDetails(this.currentDetails),this.oldDetails=this.currentDetails),this.oldColor!==this.currentColor&&(this.renderVehicleDetails(this.currentDetails),this.oldColor=this.currentColor)}},{key:"renderModelNav",value:function(t){document.querySelector("#vehicle-model__button").innerHTML=t.name;var e=document.querySelector("#vehicle-model__listbox"),r=this.vehicles.map(function(e){return'\n        <li id="'.concat(e.id,'" role="option" aria-selected="').concat(e.id===t.id,'">\n          ').concat(e.name,"\n        </li>")}).join("");e.innerHTML=r}},{key:"renderMainBillboard",value:function(e){document.querySelector("#main-billboard").style.backgroundImage="url(".concat(this.url.images).concat(e.billboardImage,")"),document.querySelector("#main-billboard .card-container__heading").innerHTML=e.name,document.querySelector("#main-billboard .card-container__paragraph").innerHTML=e.billboardDesc}},{key:"initVehicleDetailsBtn",value:function(){var t=this;this.vehicleDetailsBtn.forEach(function(e){e.addEventListener("click",function(){t.currentDetails!==e.dataset.detail&&(t.currentDetails=e.dataset.detail,t.render())})})}},{key:"renderVehicleDetails",value:function(t){this.vehicleDetailsBtn.forEach(function(e){e.dataset.detail===t?e.classList.add("is-active"):e.classList.remove("is-active")});var e=document.querySelector("#vehicle-details-container"),r=document.createElement("div");switch(r.classList.add("is-hidden"),t){case"dimensions":r.innerHTML=this.renderDimensionsDetails(this.currentVehicle);break;case"layouts":r.innerHTML=this.renderLayoutsDetails(this.currentVehicle);break;case"color":this.currentDetails!==this.oldDetails?r.appendChild(this.renderColorDetails(this.currentVehicle)):this.renderColorDetails(this.currentVehicle);break;case"interior":r.innerHTML=this.renderInteriorDetails(this.currentVehicle);break;default:console.error("".concat(t," is a wrong argument for vehicle details!"))}this.currentDetails!==this.oldDetails&&setTimeout(function(){e.innerHTML="",e.appendChild(r.firstElementChild)},60)}},{key:"renderDimensionsDetails",value:function(e){var r=e.dimensions,t=[],n="";for(var i in r.short)t.push(i);return t.forEach(function(e){var t="".concat(e.charAt(0).toUpperCase()).concat(e.slice(1).replace("_"," "));n+='\n        <tr>\n          <th class="dimensions__table__heading">'.concat(t,'</th>\n          <td class="dimensions__table__short">').concat(r.short[e],'</td>\n          <td class="dimensions__table__long">').concat(r.long[e],"</td>\n        </tr>\n      ")}),'\n          <article class="flex vehicle-details__dimensions">\n            <table class="text--left dimensions__table">\n              <thead>\n                <tr>\n                  <td></td>\n                  <th>Short</th>\n                  <th>Long</th>\n                </tr>\n              </thead>\n              <tbody>\n                '.concat(n,'\n              </tbody>\n            </table>\n            <div class="flex flex--center-align dimensions__image-container">\n              <img src="').concat(this.url.images).concat(r.image,'" alt="').concat(this.currentVehicle.name,' dimensions">\n            </div>\n          </article>\n      ')}},{key:"renderLayoutsDetails",value:function(e){var t=e.layouts;return'<article class="vehicle-details__layout">\n        <div class="vehicle-details__layout__short">\n          <p class="layout__paragraph">Short (based on '.concat(t.short.model,')</p>\n          <div>\n            <img class="layout__image" src="').concat(this.url.images).concat(t.short.image,'" alt="').concat(t.short.model,' vehicle layout">\n          </div>\n        </div>\n        <div class="vehicle-details__layout__long">\n          <p class="layout__paragraph">Long (based on ').concat(t.long.model,')</p>\n          <div>\n            <img class="layout__image" src="').concat(this.url.images).concat(t.long.image,'" alt="').concat(t.long.model,' vehicle layout">\n          </div>\n          <p class="layout__paragraph">').concat(t.long.desc,"</p>\n        </div>\n      </article>")}},{key:"initColorButtons",value:function(){var o=this,e=this.currentVehicle.colors,a=document.createElement("div");a.classList.add("color-picker__non-metallic");var c=document.createElement("div");c.classList.add("color-picker__metallic");var t=function(n){var i=document.createElement("ul");e[n].forEach(function(e){var t=document.createElement("li");t.classList.add("color-picker__list__item");var r=document.createElement("button");r.classList.add("btn","color-picker__btn"),r.style.backgroundColor=e.value,r.title=e.name,r.dataset.material=n,r.dataset.color=e.value,e===o.currentColor&&(r.classList.add("is-active"),"nonMetallic"===n?a.classList.add("is-active"):"metallic"===n&&c.classList.add("is-active")),t.appendChild(r),i.appendChild(t)}),"nonMetallic"===n?(a.appendChild(i),a.innerHTML+='\n              <p class="color-picker__description">\n                Non metallic\n              </p>'):"metallic"===n&&(c.appendChild(i),c.innerHTML+='\n              <p class="color-picker__description">\n                Metallic\n              </p>')};for(var r in e)t(r);this.colorPickerLists={nonMetallic:a,metallic:c}}},{key:"handleActiveColorBtn",value:function(e){e.dataset.color===this.currentColor.value?(e.classList.add("is-active"),"metallic"===e.dataset.material?(this.colorPickerLists.metallic.classList.add("is-active"),this.colorPickerLists.nonMetallic.classList.remove("is-active")):(this.colorPickerLists.nonMetallic.classList.add("is-active"),this.colorPickerLists.metallic.classList.remove("is-active"))):e.classList.remove("is-active")}},{key:"renderColorDetails",value:function(e){var r=this,t=e.colors,n=document.querySelector(".vehicle-details__color");if(null===n){(n=document.createElement("article")).classList.add("text--center","vehicle-details__color"),n.innerHTML='\n          <div class="color__image-container">\n            <img src="'.concat(this.url.images).concat(this.currentColor.image,'" alt="').concat(this.currentColor.name," ").concat(e.name,'">\n          </div>\n          <div class="flex flex--justify-center color__color-picker">\n          </div>\n      '),n.querySelector(".color__color-picker").appendChild(this.colorPickerLists.nonMetallic),n.querySelector(".color__color-picker").appendChild(this.colorPickerLists.metallic);var i=n.querySelectorAll(".color-picker__btn"),o=[].concat(_toConsumableArray(t.nonMetallic),_toConsumableArray(t.metallic));return i.forEach(function(e){r.handleActiveColorBtn(e),e.onclick=function(e){var t=e.target;t.dataset.color!==r.currentColor.value&&(r.currentColor=o.filter(function(e){return e.value===t.dataset.color})[0],r.render())}}),n}this.loadImage(this.url.images+this.currentColor.image).then(function(e){n.querySelector(".color__image-container").innerHTML='\n          <img src="'.concat(e,'" alt="').concat(r.currentColor.name," ").concat(r.currentVehicle.name,'">\n        ')}),n.querySelectorAll(".color-picker__btn").forEach(function(e){r.handleActiveColorBtn(e)})}},{key:"generateInteriorList",value:function(e){var t=this,r=document.createElement("ul");r.classList.add("flex","flex--space-between");var n=e.trim[2],i=e.trim.map(function(e){return'\n      <li class="interior-trim__list__item">\n        <div class="interior-trim__checkbox__container" role="checkbox" aria-checked="'.concat(e===n,'" tabindex="0" aria-label="').concat(e.material," interior trim. Insert: ").concat(e.insert,". Bolster: ").concat(e.bolster,'">\n          <div>\n            <img src="').concat(t.url.images).concat(e.image,'" alt="').concat(e.material,' interior trim">\n          </div>\n          <div class="flex flex--space-between">\n            <div>\n              <h4 class="interior-trim__description__heading">').concat(e.material,'</h4>\n              <p class="interior-trim__description__paragraph">\n                Insert: ').concat(e.insert,'\n              </p>\n              <p class="interior-trim__description__paragraph">\n                Bolster: ').concat(e.bolster,'\n              </p>\n            </div>\n            <div class="interior-trim__checkbox">\n              <button class="btn interior-trim__checkbox__btn" tabindex="-1">\n                <i class="fas fa-check"></i>\n              </button>\n            </div>\n          </div>\n        </div>\n      </li>\n      ')}).join("");return r.insertAdjacentHTML("afterbegin",i),r.outerHTML}},{key:"renderInteriorDetails",value:function(e){var t=e.interior;return'\n        <article class="flex flex--column vehicle-details__interior-trim">\n          <div class="interior-trim__top-image" style="'.concat(this.url.images).concat(t.image,'"></div>\n          <div role="group" aria-label="Interior trim">\n            ').concat(this.generateInteriorList(t),"\n          </div>\n          \x3c!-- Interior trim material checkboxes end --\x3e\n        </article>\n        \x3c!-- Vehicle interior trim container end --\x3e\n      ")}},{key:"handleVehicleGallery",value:(r=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,i,o,a,c,l,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.gallery,this.oldVehicle!==t&&clearTimeout(this.galleryTimer),i=document.querySelector(".vehicle-gallery"),o=i.querySelector(".vehicle-gallery__btn--left"),a=i.querySelector(".vehicle-gallery__btn--right"),c=i.querySelector(".vehicle-gallery__status"),l=this.url.images+n[r],e.next=9,this.loadImage(l);case 9:l=e.sent,i.style.backgroundImage="url(".concat(l,")"),c.innerHTML="".concat(r+1," / ").concat(n.length),this.galleryTimer=setTimeout(function(){r===n.length-1?r=0:r+=1,s.handleVehicleGallery(t,r)},5e3),a.onclick=function(){r===n.length-1?r=0:r+=1,clearTimeout(s.galleryTimer),s.handleVehicleGallery(t,r)},o.onclick=function(){0===r?r=n.length-1:r-=1,clearTimeout(s.galleryTimer),s.handleVehicleGallery(t,r)};case 15:case"end":return e.stop()}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"renderVehicleDescription",value:function(e){var t=document.querySelector(".vehicle-description"),r=e.description.map(function(e){return"<p>".concat(e,"</p>")}).join("");t.querySelector("div").innerHTML=r}},{key:"handleOffersBtn",value:function(t){document.querySelectorAll(".btn--offers").forEach(function(e){return e.innerHTML="View our ".concat(t.name," offers")})}},{key:"handleInterestedModal",value:function(e){var t=document.querySelector(".interested-modal");t.querySelector(".card-container__paragraph").innerHTML="\n      Are you interested in the ".concat(e.name,"? Simply fill in the form bellow and we'll be in touch.\n    "),t.querySelector("#modal__close-btn").onclick=function(){return t.classList.add("is-closed")},t.querySelector(".interested-modal__form__input--btn").onclick=function(){t.classList.add("is-closed")},document.onscroll=function(){document.querySelector(".vehicle-description").offsetTop<=window.pageYOffset&&(t.classList.remove("is-closed"),document.onscroll=null)}}},{key:"loadImage",value:function(n){return new Promise(function(e,t){var r=new Image;r.src=n,r.onload=function(){return e(n)},r.onerror=function(e){return t(e)}})}}]),e}();